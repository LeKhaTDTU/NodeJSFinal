<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Products</title>
    <script src="/js/workspace.js" defer></script>
    <link rel="stylesheet" href="/css/transaction.css">
    <script src="https://kit.fontawesome.com/ad1797946c.js" crossorigin="anonymous"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,300;0,400;0,500;0,700;1,100;1,300&display=swap" rel="stylesheet">
    </head>
    <body>
        <%- include('navbar') %>
        <header>
            <div class="product-search" >
                <form action="/transaction" method="GET">
                    <input type="text" id="product-search" name="product_name" placeholder="Enter product name or id...">
                    <button><i class="fa-solid fa-magnifying-glass"></i></button>
                </form>
            </div>                
        </header>
        <main>
            <div class="container">
                <ul class="product-category">
                    <li class="category" style="text-align: center;"><a href="/transaction/phone">Mobile Phone <i class="fa-solid fa-mobile-screen-button"></i></a></li>
                    <li class="category" style="text-align: center;"><a href="/transaction/earphone">Headphones <i class="fa-solid fa-headphones"></i></a></li>
                    <li class="category" style="text-align: center;"><a href="/transaction/charging">Charger <i class="fa-solid fa-bolt"></i></a></li>
                    <li class="category" style="text-align: center;"><a href="/transaction/laptop">Laptop <i class="fa-solid fa-laptop"></i></a></li>
                    <li class="category" style="text-align: center;"><a href="/transaction/apple">Apple <i class="fa-brands fa-apple"></i></a></li>
                    <!-- <li class="category" style="text-align: center;"><a href="/products/phone">Dessert <i class="fa-solid fa-ice-cream"></i></a></li> -->
                    
                </ul>
            
            <div class="product-grid">
                
                <div class="product-grid-item">
                    <% products.forEach(p => { %>
                        <div class="product-item" data-id="<%= p.product_id %>" data-price="<%= p.retail_price %>" data-name="<%= p.product_name %>">
                            <img src="/images/<%=p.image %>" alt="">
                            <div>
                                <p style="text-align: center;" class="product-name" ><%= p.product_name %></p>
                                <p style="text-align: center;" class="product-name" ><%= p.retail_price %>$</p>
                            </div>
                        </div>
                    <% }) %>
                </div>
                
            </div>
                
                            
            <div class="product-order">
                <h1>YOUR ORDER</h1>
                <p>Name:<input type="text" id="nameInput" name="name" style="border: none; outline: none; padding: 4px" oninput="validateName()" maxlength="20"></p>
                <p>Phone:<input type="tel" id="phoneNumberInput" name="phone" style="border: none; outline: none; padding: 4px" oninput="validatePhoneNumber()" maxlength="11"></p>
                <p>Date: <input type="text" id="dateInput" style="border: none; outline: none; padding: 4px" readonly></p>
                <hr>

                <div class="product-selected">
                
                        <table class="selected-detail">
                            <thead>
                                <tr>
                                    <th style="width: 50%">Name</th>
                                    <th>Quantity</th>
                                    <th style="width: 20%;">Price</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody id="product-table-body">

                            </tbody>

                            <tfoot>
                                <tr style="background-color: #c2c2c2;">
                                    
                                    <!-- <td id="total-quantity" >0</td>
                                    <td id="total-cost">0</td> -->
                                </tr>
                            </tfoot>
                        </table>
                </div>
                <div class="total-payment">
                    
                    <div><strong>Total quantity</strong>: <span id="total-quantity">0</span></div>
                    <div><strong>Total cost</strong>: <span id="total-cost">0</span></div>
                    <div><strong>Customer gives: </strong><input type="number" id="customerPay"></div>
                    <div><strong>Change: </strong><span id="changeToCustomer">0</span></div>
                </div>
                <div class="cart-process">
                    <div class="cart-buttons">
                        <button id="clear-cart">Clear <i class="fa-regular fa-trash-can"></i></button>
                        <button id="complete-payment">Confirm <i class="fa-solid fa-check"></i></button>
                    </div> 
                </div>
            </div>
        </main>
    </body>

    <script>
        // function calChange() {
        //     const total_cost = parseInt(document.getElementById('total-cost').textContent)
        //     const customer_pay = parseInt(document.getElementById('customerPay').value)
        //     const changeToCustomer = document.getElementById('changeToCustomer')
        //     if(!customer_pay) {
        //         changeToCustomer.textContent = 0
        //         return ;
        //     }
        //     const change = customer_pay - total_cost
        //     changeToCustomer.textContent = change
        //     console.log(customer_pay)
        //     console.log(changeToCustomer.textContent)

        // }

        //This function is for "Phone" to receive only numbers
        function validatePhoneNumber() {
        // Get the input element
        var phoneInput = document.getElementById('phoneNumberInput');
        
        // Remove non-numeric characters using a regular expression
        phoneInput.value = phoneInput.value.replace(/\D/g, '');
    }
        //This function is for "Name" to receive only letters
        function validateName() {
        // Get the input element
        var nameInput = document.getElementById('nameInput');
        
        // Remove non-alphabetic characters using a regular expression
        nameInput.value = nameInput.value.replace(/[^A-Za-z]/g, '');
    }

        // Function to format the date and time as DD/MM/YYYY HH:mm:ss
        function formatDateTime(dateTime) {
        const options = { 
            day: '2-digit', 
            month: '2-digit', 
            year: 'numeric',
            hour: '2-digit',
            minute: '2-digit',
            second: '2-digit',
            hour12: false
        };
        return new Intl.DateTimeFormat('en-GB', options).format(dateTime);
    }

    // Set the current date and time when the page loads
    document.addEventListener('DOMContentLoaded', function() {
        const dateInput = document.getElementById('dateInput');
        const currentDate = new Date();
        dateInput.value = formatDateTime(currentDate);
    });
    </script>
        
</html>
